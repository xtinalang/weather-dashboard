{% extends "base.html" %}

{% block title %}Weather Dashboard - Home{% endblock %}

{% block content %}
<title>Weather Dashboard - Home</title>
<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <div class="flash-messages">
            {% for category, message in messages %}
                <div class="flash-message {{ category }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}
{% endwith %}

<div class="container mt-5">
    <h1>Weather Dashboard</h1>

    <!-- Natural Language Query Section -->
    <div class="card mb-4">
        <div class="card-body">
            <h2 class="card-title">Ask About Weather</h2>
            <form method="POST" action="{{ url_for('nl_date_weather') }}" class="mt-3">
                {{ nl_form.csrf_token }}
                <div class="form-group">
                    {{ nl_form.query.label(class="form-label") }}
                    {{ nl_form.query(class="form-control", placeholder="e.g., What's the weather like in London on Monday?") }}
                </div>
                {{ nl_form.submit(class="btn btn-primary mt-2") }}
            </form>
        </div>
    </div>

    <!-- Existing Search Forms -->
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h2 class="card-title">Search Location</h2>
                    <form method="POST" action="{{ url_for('search') }}">
                        {{ search_form.csrf_token }}
                        <div class="form-group">
                            {{ search_form.query.label(class="form-label") }}
                            {{ search_form.query(class="form-control", placeholder="Enter city name") }}
                        </div>
                        <button type="submit" class="btn btn-primary mt-2">Search</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h2 class="card-title">Enter Coordinates</h2>
                    <form method="POST" action="{{ url_for('ui_location') }}">
                        {{ ui_form.csrf_token }}
                        <div class="form-group">
                            {{ ui_form.location.label(class="form-label") }}
                            {{ ui_form.location(class="form-control", placeholder="Enter coordinates (e.g., 51.5074, -0.1278)") }}
                        </div>
                        <button type="submit" class="btn btn-primary mt-2">Get Weather</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Favorites Section -->
    {% if favorites %}
    <div class="card mt-4">
        <div class="card-body">
            <h2 class="card-title">Favorite Locations</h2>
            <div class="list-group">
                {% for location in favorites %}
                <a href="{{ url_for('weather_path', coordinates=location.latitude ~ '/' ~ location.longitude) }}"
                   class="list-group-item list-group-item-action">
                    {{ location.name }}, {{ location.region }}, {{ location.country }}
                </a>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}
</div>

<!-- Quick Links -->
<div class="section">
    <h2>Popular Cities</h2>
    <div class="quick-links">
        <form action="{{ url_for('ui_location') }}" method="post" style="display: inline-block; margin: 5px;">
            {{ ui_form.csrf_token }}
            <input type="hidden" name="location" value="London">
            <input type="hidden" name="unit" value="C">
            <button type="submit" class="btn">London</button>
        </form>
        <form action="{{ url_for('ui_location') }}" method="post" style="display: inline-block; margin: 5px;">
            {{ ui_form.csrf_token }}
            <input type="hidden" name="location" value="New York">
            <input type="hidden" name="unit" value="C">
            <button type="submit" class="btn">New York</button>
        </form>
        <form action="{{ url_for('ui_location') }}" method="post" style="display: inline-block; margin: 5px;">
            {{ ui_form.csrf_token }}
            <input type="hidden" name="location" value="Tokyo">
            <input type="hidden" name="unit" value="C">
            <button type="submit" class="btn">Tokyo</button>
        </form>
        <form action="{{ url_for('ui_location') }}" method="post" style="display: inline-block; margin: 5px;">
            {{ ui_form.csrf_token }}
            <input type="hidden" name="location" value="Sydney">
            <input type="hidden" name="unit" value="C">
            <button type="submit" class="btn">Sydney</button>
        </form>
    </div>
</div>
{% endblock %}
